require=function r(s,a,c){function p(o,t){if(!a[o]){if(!s[o]){var e="function"==typeof require&&require;if(!t&&e)return e(o,!0);if(l)return l(o,!0);var i=new Error("Cannot find module '"+o+"'");throw i.code="MODULE_NOT_FOUND",i}var n=a[o]={exports:{}};s[o][0].call(n.exports,function(t){var e=s[o][1][t];return p(e||t)},n,n.exports,r,s,a,c)}return a[o].exports}for(var l="function"==typeof require&&require,t=0;t<c.length;t++)p(c[t]);return p}({Bullet:[function(t,e,o){"use strict";cc._RF.push(e,"09d6fIoChtHG5U1cLvo+xPl","Bullet"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.angle=0,t.attack=3,t.speed=10,t.bulletLevel=1,t}return __extends(t,e),t.prototype.shot=function(t,e){this.game=t,this.enabled=!0;var o=t.weaponNode.parent.convertToWorldSpaceAR(t.weaponNode.getPosition());this.angle=t.weaponNode.rotation,this.node.rotation=this.angle;var i=cc.p(o.x+50*Math.sin(this.angle/180*3.14),o.y+50*Math.cos(this.angle/180*3.14));this.setBullet(e),this.node.position=i,this.node.parent=cc.director.getScene()},t.prototype.setBullet=function(t){this.bulletLevel=t,this.node.getComponent(cc.Sprite).spriteFrame=this.game.spAtlas.getSpriteFrame("bullet"+t)},t.prototype.update=function(t){var e=this.node.x,o=this.node.y;e+=t*this.speed*Math.sin(this.angle/180*3.14),o+=t*this.speed*Math.cos(this.angle/180*3.14),this.node.x=e,this.node.y=o,(this.node.x>cc.director.getWinSize().width+100||this.node.x<-100||this.node.y>cc.director.getWinSize().height+100||this.node.y<0)&&this.game.despawnBullet(this.node)},t.prototype.onCollisionEnter=function(t,e){var o=e.world.points,i=cc.pMidpoint(o[0],o[3]);this.game.castNet(i),this.game.despawnBullet(this.node)},t.prototype.getAttackValue=function(){return this.attack*this.bulletLevel},__decorate([r],t.prototype,"speed",void 0),t=__decorate([n],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],CoinsControls:[function(t,e,o){"use strict";cc._RF.push(e,"6569cF6oL9HN4K8tQKUGQuC","CoinsControls"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Coins"),n=t("./NumUp"),r=cc._decorator,s=r.ccclass,a=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.coinPlusPrefab=null,t.coinsPrefab=null,t.number1=null,t.number2=null,t.number3=null,t.number4=null,t.number5=null,t.number6=null,t.timerAtlas=null,t.currnetValue=0,t.toValue=0,t}return __extends(t,e),t.prototype.init=function(){this.coinUpPool=new cc.NodePool,this.coinsPool=new cc.NodePool,this.setValue(this.currnetValue)},t.prototype.prefixInteger=function(t,e){return(Array(e).join("0")+t).slice(-e)},t.prototype.setValue=function(t){var e=this.prefixInteger(t,6).split("");this.number1.spriteFrame=this.timerAtlas.getSpriteFrame(e[0].toString()),this.number2.spriteFrame=this.timerAtlas.getSpriteFrame(e[1].toString()),this.number3.spriteFrame=this.timerAtlas.getSpriteFrame(e[2].toString()),this.number4.spriteFrame=this.timerAtlas.getSpriteFrame(e[3].toString()),this.number5.spriteFrame=this.timerAtlas.getSpriteFrame(e[4].toString()),this.number6.spriteFrame=this.timerAtlas.getSpriteFrame(e[5].toString())},t.prototype.addCoins=function(t){this.currnetValue+=t,this.setValue(this.currnetValue)},t.prototype.reduceCoin=function(t){return this.currnetValue>=t&&(this.setValue(this.currnetValue-=t),!0)},t.prototype.gainCoins=function(t,e){0<this.coinUpPool.size()?this.coinUp=this.coinUpPool.get():this.coinUp=cc.instantiate(this.coinPlusPrefab),this.coinUp.getComponent(n.default).init(t,e,this),0<this.coinsPool.size()?this.oneCoin=this.coinsPool.get():this.oneCoin=cc.instantiate(this.coinsPrefab),console.log(this.coinsPool.size()),this.oneCoin.getComponent(i.default).init(this);var o=this.node.convertToWorldSpaceAR(this.number3.node.position);this.oneCoin.getComponent(i.default).goDown(t,o),this.addCoins(e)},t.prototype.despawnCoins=function(t){this.coinsPool.put(t)},t.prototype.despawnCoinup=function(t){this.coinUpPool.put(t)},__decorate([a(cc.Prefab)],t.prototype,"coinPlusPrefab",void 0),__decorate([a(cc.Prefab)],t.prototype,"coinsPrefab",void 0),__decorate([a(cc.Sprite)],t.prototype,"number1",void 0),__decorate([a(cc.Sprite)],t.prototype,"number2",void 0),__decorate([a(cc.Sprite)],t.prototype,"number3",void 0),__decorate([a(cc.Sprite)],t.prototype,"number4",void 0),__decorate([a(cc.Sprite)],t.prototype,"number5",void 0),__decorate([a(cc.Sprite)],t.prototype,"number6",void 0),__decorate([a(cc.SpriteAtlas)],t.prototype,"timerAtlas",void 0),__decorate([a],t.prototype,"currnetValue",void 0),__decorate([a],t.prototype,"toValue",void 0),t=__decorate([s],t)}(cc.Component);o.default=c,cc._RF.pop()},{"./Coins":"Coins","./NumUp":"NumUp"}],Coins:[function(t,e,o){"use strict";cc._RF.push(e,"7c663xCLHdMdIWj6+ewSHV9","Coins"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anim=null,t}return __extends(t,e),t.prototype.init=function(t){this.coinsControls=t,this.anim.play("goldDown")},t.prototype.goDown=function(t,e){this.node.parent=cc.director.getScene(),this.node.position=t;var o=cc.spawn(cc.moveTo(.8,e),cc.scaleTo(.8,.5)),i=cc.callFunc(this.despawnCoin,this),n=cc.sequence(o,i);this.node.runAction(n)},t.prototype.despawnCoin=function(){this.coinsControls.despawnCoins(this.node)},__decorate([r(cc.Animation)],t.prototype,"anim",void 0),t=__decorate([n],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],FishType:[function(t,e,o){"use strict";var i,n;cc._RF.push(e,"880eaLn4QdIGpk3aAj1Ln8r","FishType"),Object.defineProperty(o,"__esModule",{value:!0}),(n=i||(i={}))[n.alive=0]="alive",n[n.dead=1]="dead",o.FishState=i,cc._RF.pop()},{}],Fish:[function(t,e,o){"use strict";cc._RF.push(e,"32fc6fuwQNO7qbAS5F1JW2i","Fish"),Object.defineProperty(o,"__esModule",{value:!0});var c=t("./FishType"),i=t("./Bullet"),n=cc._decorator,r=n.ccclass,s=n.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anim=null,t.hp=10,t.gold=10,t.fishState=c.FishState.alive,t.bezier1=[cc.p(50,-100),cc.p(300,-400),cc.p(1800,-650)],t.bezier2=[cc.p(100,-200),cc.p(400,-300),cc.p(1800,-600)],t.bezier3=[cc.p(150,-300),cc.p(600,-400),cc.p(1800,-500)],t.bezier4=[cc.p(50,50),cc.p(400,100),cc.p(1800,200)],t.bezier5=[cc.p(80,200),cc.p(300,500),cc.p(1800,650)],t.bezier6=[cc.p(100,100),cc.p(350,400),cc.p(1800,500)],t.bezier7=[cc.p(100,2),cc.p(350,-2),cc.p(1800,0)],t.bezierArray=new Array,t}return __extends(t,e),t.prototype.init=function(t){this.bezierArray.push(this.bezier1),this.bezierArray.push(this.bezier2),this.bezierArray.push(this.bezier3),this.bezierArray.push(this.bezier4),this.bezierArray.push(this.bezier5),this.bezierArray.push(this.bezier6),this.bezierArray.push(this.bezier6),this.game=t,this.enabled=!0,this.spawnFish(t)},t.prototype.spawnFish=function(t){var e=t.fishTypes.length,o=Math.floor(cc.random0To1()*e);this.fishType=t.fishTypes[o];var i=cc.p(100*-cc.random0To1()-200,300*cc.randomMinus1To1()+350);this.node.position=cc.find("Canvas").convertToNodeSpaceAR(i);var n=Math.floor(cc.random0To1()*this.bezierArray.length),r=this.bezierArray[n],s=r[0],a=Math.atan(s.y/s.x);this.node.rotation=180*-a/3.14,this.node.getComponent(cc.Sprite).spriteFrame=this.game.spAtlas.getSpriteFrame(this.fishType.name+"_run_0"),this.hp=this.fishType.hp,this.gold=this.fishType.gold,this.fishState=c.FishState.alive,this.anim.play(this.fishType.name+"_run"),this.node.parent=cc.find("Canvas"),this.lastPosition=this.node.getPosition(),this.changeCollier(),this.swimFish(r)},t.prototype.changeCollier=function(){this.node.getComponent(cc.BoxCollider).size=this.node.getContentSize()},t.prototype.swimFish=function(t){cc.director.getWinSize();var e=10*cc.random0To1()+10,o=cc.bezierBy(e,t);this.node.runAction(o)},t.prototype.update=function(){this.updateDegree()},t.prototype.updateDegree=function(){var t,e=this.node.getPosition();cc.pDistance(this.lastPosition,e)<1||(t=e.x-this.lastPosition.x==0?0<e.y-this.lastPosition.y?-90:90:180*-Math.atan((e.y-this.lastPosition.y)/(e.x-this.lastPosition.x))/3.14,this.node.rotation=t,this.lastPosition=e,this.beAttack())},t.prototype.beAttack=function(){if(this.isDie()){this.node.stopAllActions(),this.anim.play(this.fishType.name+"_dead").on("stop",this.dieCallback,this);var t=this.node.parent.convertToWorldSpaceAR(this.node.position);this.game.gainCoins(t,this.gold)}else this.despawnFish()},t.prototype.isDie=function(){return this.fishState==c.FishState.dead},t.prototype.dieCallback=function(){this.node.stopAllActions(),this.game.despawnFish(this.node)},t.prototype.despawnFish=function(){(900<this.node.x||this.node.x<-1e3||600<this.node.y||this.node.y<-900)&&(this.node.stopAllActions(),this.game.despawnFish(this.node))},t.prototype.onCollisionEnter=function(t,e){var o=t.node.getComponent(i.default);this.hp-=o.getAttackValue(),this.hp<=0&&(this.fishState=c.FishState.dead)},__decorate([s(cc.Animation)],t.prototype,"anim",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{"./Bullet":"Bullet","./FishType":"FishType"}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"e0e243AQyFAnaMaBneifGAj","Game"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Fish"),n=t("./Bullet"),s=t("./Net"),a=t("./CoinsControls"),c=t("./Weapon"),r=cc._decorator,p=r.ccclass,l=r.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fishPrefab=null,t.weaponNode=null,t.bulletPrefab=null,t.netPrefab=null,t.coinsControls=null,t.spAtlas=null,t.gameoverNode=null,t}return __extends(t,e),t.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0,this.bulletPool=new cc.NodePool(n.default),this.fishPool=new cc.NodePool(i.default),this.netPool=new cc.NodePool(s.default);for(var t=0;t<10;t++){var e=cc.instantiate(this.fishPrefab);this.fishPool.put(e)}cc.find("Canvas/bg").setLocalZOrder(-1),cc.find("Canvas/btmBar").setLocalZOrder(1),this.gameoverNode.setLocalZOrder(2),this.gameoverNode.active=!1,this.coinsControls.getComponent(a.default).init(),this.weaponNode.getComponent(c.default).init();var r=this;cc.director.setDisplayStats(!0),cc.loader.loadRes("FishConfig",function(t,e){t?cc.error(t.message||t):(r.fishTypes=e,r.schedule(r.createFish,2))}),this.node.on(cc.Node.EventType.TOUCH_START,function(t){var e=r.weaponNode.parent.convertTouchToNodeSpaceAR(t.touch),o=r.weaponNode.getPosition();if(!(e.y<o.y)){var i=180*Math.atan((e.x-o.x)/(e.y-o.y))/3.14;r.weaponNode.rotation=i;var n=r.weaponNode.getComponent(c.default).curLevel;r.shot(n)}},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){},this),this.node.on(cc.Node.EventType.TOUCH_END,function(t){},this)},t.prototype.shot=function(t){0<this.bulletPool.size()?this.oneBullet=this.bulletPool.get(this):this.oneBullet=cc.instantiate(this.bulletPrefab),this.coinsControls.getComponent(a.default).reduceCoin(t)?this.oneBullet.getComponent(n.default).shot(this,t):0==this.coinsControls.getComponent(a.default).currnetValue&&this.gameOver()},t.prototype.createFish=function(){for(var t=0;t<3;t++){(0<this.fishPool.size()?this.fishPool.get(this):cc.instantiate(this.fishPrefab)).getComponent(i.default).init(this)}},t.prototype.castNet=function(t){0<this.netPool.size()?this.oneNet=this.netPool.get(this):this.oneNet=cc.instantiate(this.netPrefab);var e=this.weaponNode.getComponent(c.default).curLevel;this.oneNet.getComponent(s.default).init(t,this,e)},t.prototype.despawnFish=function(t){this.fishPool.put(t)},t.prototype.despawnBullet=function(t){this.bulletPool.put(t)},t.prototype.despawnNet=function(t){this.netPool.put(t)},t.prototype.gainCoins=function(t,e){this.coinsControls.getComponent(a.default).gainCoins(t,e)},t.prototype.gameOver=function(){this.gameoverNode.active=!0,this.unscheduleAllCallbacks()},t.prototype.gameReStart=function(){cc.director.loadScene("fishmain")},__decorate([l(cc.Prefab)],t.prototype,"fishPrefab",void 0),__decorate([l(cc.Node)],t.prototype,"weaponNode",void 0),__decorate([l(cc.Prefab)],t.prototype,"bulletPrefab",void 0),__decorate([l(cc.Prefab)],t.prototype,"netPrefab",void 0),__decorate([l(cc.Node)],t.prototype,"coinsControls",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"spAtlas",void 0),__decorate([l(cc.Node)],t.prototype,"gameoverNode",void 0),t=__decorate([p],t)}(cc.Component);o.default=h,cc._RF.pop()},{"./Bullet":"Bullet","./CoinsControls":"CoinsControls","./Fish":"Fish","./Net":"Net","./Weapon":"Weapon"}],Net:[function(t,e,o){"use strict";cc._RF.push(e,"39c34IDr8NF9qSzUX5oiTg+","Net"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anim=null,t.curLevel=1,t}return __extends(t,e),t.prototype.init=function(t,e,o){this.curLevel=o,this.node.parent=cc.director.getScene(),this.node.position=t,this.game=e,this.anim.play("net_"+this.curLevel)},t.prototype.despawnNet=function(){this.game.despawnNet(this.node)},__decorate([r(cc.Animation)],t.prototype,"anim",void 0),t=__decorate([n],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],NumUp:[function(t,e,o){"use strict";cc._RF.push(e,"a76e4khyIZORp6Ad1rbO4Ni","NumUp"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anim=null,t.numAtlas=null,t.tensPlace=null,t.onesPlace=null,t}return __extends(t,e),t.prototype.init=function(t,e,o){this.coinsControls=o;var i=e.toString().split("");1==i.length?(this.onesPlace.node.active=!1,this.tensPlace.spriteFrame=this.numAtlas.getSpriteFrame("goldnum_"+i[0])):(this.onesPlace.node.active=!0,this.tensPlace.spriteFrame=this.numAtlas.getSpriteFrame("goldnum_"+i[0]),this.onesPlace.spriteFrame=this.numAtlas.getSpriteFrame("goldnum_"+i[1])),this.node.parent=cc.director.getScene(),this.node.position=t,this.anim.play("coinsUp").on("stop",this.despawn,this)},t.prototype.despawn=function(){this.coinsControls.despawnCoinup(this.node)},__decorate([r(cc.Animation)],t.prototype,"anim",void 0),__decorate([r(cc.SpriteAtlas)],t.prototype,"numAtlas",void 0),__decorate([r(cc.Sprite)],t.prototype,"tensPlace",void 0),__decorate([r(cc.Sprite)],t.prototype,"onesPlace",void 0),t=__decorate([n],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],WaterWaveEffect:[function(t,e,o){"use strict";cc._RF.push(e,"abfb8TanPpMPaR8+PE0x759","WaterWaveEffect"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./WaterWaveFrag"),n=cc._decorator,r=n.ccclass,s=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startTime=Date.now(),t.time=0,t.resolution={x:0,y:0},t}return __extends(t,e),t.prototype.onLoad=function(){this.resolution.x=this.node.getContentSize().width,this.resolution.y=this.node.getContentSize().height,this.userWater()},t.prototype.start=function(){},t.prototype.userWater=function(){if(this.program=new cc.GLProgram,cc.sys.isNative?this.program.initWithString(i.default.waterwave_vert,i.default.waterwave_frag):(this.program.initWithVertexShaderByteArray(i.default.waterwave_vert,i.default.waterwave_frag),this.program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),this.program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),this.program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD,cc.macro.VERTEX_ATTRIB_TEX_COORDS)),this.program.link(),this.program.updateUniforms(),this.program.use(),cc.sys.isNative){var t=cc.GLProgramState.getOrCreateWithGLProgram(this.program);t.setUniformFloat("time",this.time),t.setUniformVec2("resolution",this.resolution)}else{var e=this.program.getUniformLocationForName("resolution"),o=this.program.getUniformLocationForName("time");this.program.setUniformLocationWith2f(e,this.resolution.x,this.resolution.y),this.program.setUniformLocationWith1f(o,this.time)}this.setProgram(this.node.getComponent(cc.Sprite)._sgNode,this.program)},t.prototype.setProgram=function(t,e){if(cc.sys.isNative){var o=cc.GLProgramState.getOrCreateWithGLProgram(e);t.setGLProgramState(o)}else t.setShaderProgram(e)},t.prototype.update=function(t){if(this.time=(Date.now()-this.startTime)/1e3,this.program)if(this.program.use(),cc.sys.isNative){cc.GLProgramState.getOrCreateWithGLProgram(this.program).setUniformFloat("time",this.time)}else{var e=this.program.getUniformLocationForName("time");this.program.setUniformLocationWith1f(e,this.time)}},t=__decorate([r],t)}(cc.Component));o.default=s,cc._RF.pop()},{"./WaterWaveFrag":"WaterWaveFrag"}],WaterWaveFrag:[function(t,e,o){"use strict";cc._RF.push(e,"29852NvdVdLq5TL/Y7OvJW0","WaterWaveFrag"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){}return t.waterwave_vert="\n    attribute vec4 a_position;\n    attribute vec2 a_texCoord;\n    attribute vec4 a_color;\n    varying vec2 v_texCoord;\n    varying vec4 v_fragmentColor;\n    void main()\n    {\n        gl_Position = CC_PMatrix * a_position;\n        v_fragmentColor = a_color;\n        v_texCoord = a_texCoord;\n    }\n    ",t.waterwave_frag="\n    #ifdef GL_ES\n    precision mediump float;\n    #endif\n    \n    #define F cos(x-y)*cos(y),sin(x+y)*sin(y)\n\n    uniform float time;\n    uniform vec2 resolution;\n    varying vec2 v_texCoord;\n\n    vec2 s(vec2 p)\n    {\n        float d=time*0.2,x=8.*(p.x+d),y=8.*(p.y+d);\n        return vec2(F);\n    }\n    void mainImage( out vec4 fragColor, in vec2 fragCoord )\n    {\n        // 换成resolution\n        vec2 rs = resolution.xy;\n        // 换成纹理坐标v_texCoord.xy\n        vec2 uv = v_texCoord.xy;\n        vec2 q = uv+2./resolution.x*(s(uv)-s(uv+rs));\n        //反转y\n        // q.y=1.-q.y;\n        fragColor = texture2D(CC_Texture0,q);\n    }\n    void main()\n    {\n        mainImage(gl_FragColor, gl_FragCoord.xy);\n    }\n    ",t}();o.default=i,cc._RF.pop()},{}],Weapon:[function(t,e,o){"use strict";cc._RF.push(e,"1ebe1mfeExLvLNsZJ3OtLKf","Weapon"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,r=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anim=null,t}return __extends(t,e),t.prototype.init=function(){this.curLevel=1,this.total=this.anim.getClips().length},t.prototype.toPlus=function(){this.curLevel+1>this.total?this.curLevel=this.total:this.curLevel++,this.anim.play("weapon_level_"+this.curLevel)},t.prototype.toMinus=function(){this.curLevel<2?this.curLevel=1:this.curLevel--,this.anim.play("weapon_level_"+this.curLevel)},t.prototype.onLoad=function(){this.init()},__decorate([r(cc.Animation)],t.prototype,"anim",void 0),t=__decorate([n],t)}(cc.Component);o.default=s,cc._RF.pop()},{}]},{},["Bullet","Coins","CoinsControls","Fish","FishType","Game","Net","NumUp","WaterWaveEffect","WaterWaveFrag","Weapon"]);