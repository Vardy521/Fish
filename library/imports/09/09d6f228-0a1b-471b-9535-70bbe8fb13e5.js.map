{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\Bullet.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["import Game from \"./Game\";\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Bullet extends cc.Component {\r\n    angle:number=0;//子弹初始角度\r\n    game:Game;\r\n    private attack:number=3;//子弹攻击力\r\n\r\n    @property\r\n    speed:number=10;\r\n    \r\n    bulletLevel:number=1;//子弹等级\r\n\r\n    shot(game:Game,level:number){\r\n        this.game=game;\r\n        this.enabled=true;//启动update函数\r\n        let weaponSite=game.weaponNode.parent.convertToWorldSpaceAR(game.weaponNode.getPosition());//将game.weaponNode的坐标转换为相对于世界坐标系下的game.weaponNode.parent锚点的坐标\r\n        this.angle=game.weaponNode.rotation;\r\n        this.node.rotation=this.angle;\r\n        let bpos=cc.p(weaponSite.x+50*Math.sin(this.angle/180*3.14),weaponSite.y+50*Math.cos(this.angle/180*3.14));\r\n        this.setBullet(level);\r\n        this.node.position=bpos;\r\n        this.node.parent=cc.director.getScene();//场景节点\r\n    }\r\n    //根据武器等级设置子弹等级\r\n    setBullet(lev:number){\r\n        this.bulletLevel=lev;\r\n        this.node.getComponent(cc.Sprite).spriteFrame=this.game.spAtlas.getSpriteFrame(\"bullet\"+lev);\r\n    }\r\n    update(dt){\r\n        let bx=this.node.x;\r\n        let by=this.node.y;\r\n        bx+=dt*this.speed*Math.sin(this.angle/180*3.14);\r\n        by+=dt*this.speed*Math.cos(this.angle/180*3.14);\r\n        this.node.x=bx;\r\n        this.node.y=by;\r\n        if(this.node.x>cc.director.getWinSize().width+100\r\n        || this.node.x<-100\r\n        || this.node.y>cc.director.getWinSize().height+100\r\n        || this.node.y<0\r\n        ){\r\n            this.game.despawnBullet(this.node);\r\n        }\r\n    }\r\n    //碰撞产生时\r\n    onCollisionEnter(other,self){\r\n        let posb=self.world.points;//矩形碰撞组件顶点坐标，左上左下右下右上\r\n        let posNet=cc.pMidpoint(posb[0],posb[3]);//取左上和右上坐标计算中点当做碰撞中点\r\n       // console.log(this.game);\r\n        this.game.castNet(posNet);\r\n        this.game.despawnBullet(this.node);\r\n    }\r\n    getAttackValue():number{\r\n        return this.attack*this.bulletLevel;\r\n    }\r\n}\r\n"]}