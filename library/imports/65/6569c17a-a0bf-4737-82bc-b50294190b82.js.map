{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\CoinsControls.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["import Coins from \"./Coins\";\r\nimport NumUp from \"./NumUp\";\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class CoinsControls extends cc.Component {\r\n    @property(cc.Prefab)\r\n    coinPlusPrefab:cc.Prefab=null;\r\n\r\n    @property(cc.Prefab)\r\n    coinsPrefab:cc.Prefab=null;\r\n\r\n    @property(cc.Sprite)\r\n    number1:cc.Sprite=null;\r\n\r\n    @property(cc.Sprite)\r\n    number2:cc.Sprite=null;\r\n\r\n    @property(cc.Sprite)\r\n    number3:cc.Sprite=null;\r\n\r\n    @property(cc.Sprite)\r\n    number4:cc.Sprite=null;\r\n\r\n    @property(cc.Sprite)\r\n    number5:cc.Sprite=null;\r\n\r\n    @property(cc.Sprite)\r\n    number6:cc.Sprite=null;\r\n\r\n    @property(cc.SpriteAtlas)\r\n    timerAtlas:cc.SpriteAtlas=null;\r\n\r\n    @property\r\n    currnetValue:number=0;\r\n\r\n    @property\r\n    toValue:number=0;\r\n\r\n    coinUpPool:cc.NodePool;\r\n    coinsPool:cc.NodePool;\r\n\r\n    coinUp:cc.Node;//+金币数字\r\n    oneCoin:cc.Node;//获得金币\r\n\r\n    init(){\r\n        this.coinUpPool=new cc.NodePool();\r\n        this.coinsPool=new cc.NodePool();\r\n        this.setValue(this.currnetValue);\r\n    }\r\n\r\n    //功能函数：数字固定长度length,不够的补0\r\n    prefixInteger(num:number,length:number){\r\n        return (Array(length).join('0')+num).slice(-length);\r\n    }\r\n    setValue(val:number){\r\n        let str=this.prefixInteger(val,6);\r\n        let nums=str.split('');\r\n        this.number1.spriteFrame=this.timerAtlas.getSpriteFrame(nums[0].toString());\r\n        this.number2.spriteFrame=this.timerAtlas.getSpriteFrame(nums[1].toString());\r\n        this.number3.spriteFrame=this.timerAtlas.getSpriteFrame(nums[2].toString());\r\n        this.number4.spriteFrame=this.timerAtlas.getSpriteFrame(nums[3].toString());\r\n        this.number5.spriteFrame=this.timerAtlas.getSpriteFrame(nums[4].toString());\r\n        this.number6.spriteFrame=this.timerAtlas.getSpriteFrame(nums[5].toString());\r\n    }\r\n    //获取金币加数\r\n    addCoins(val:number){\r\n        this.currnetValue+=val;\r\n        this.setValue(this.currnetValue);\r\n    }\r\n    //发射子弹消耗金币\r\n    reduceCoin(val:number):boolean{\r\n        if(this.currnetValue>=val){\r\n            this.setValue(this.currnetValue-=val);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    //加金币\r\n    gainCoins(coinPos:cc.Vec2,coinnum:number){\r\n        //上升消失动画的数字对象池\r\n        if(this.coinUpPool.size()>0){\r\n            this.coinUp=this.coinUpPool.get();\r\n        }else{\r\n            this.coinUp=cc.instantiate(this.coinPlusPrefab);\r\n        }\r\n        this.coinUp.getComponent(NumUp).init(coinPos,coinnum,this);\r\n        //掉落的金币对象池\r\n        if(this.coinsPool.size()>0){\r\n             this.oneCoin=this.coinsPool.get();\r\n            //this.oneCoin=cc.instantiate(this.coinsPrefab);\r\n        }else{\r\n            this.oneCoin=cc.instantiate(this.coinsPrefab);\r\n        }\r\n        console.log(this.coinsPool.size());\r\n        this.oneCoin.getComponent(Coins).init(this);\r\n        //将掉落的金币坐标转为世界坐标\r\n        let toPos=this.node.convertToWorldSpaceAR(this.number3.node.position);//\r\n        this.oneCoin.getComponent(Coins).goDown(coinPos,toPos)\r\n        this.addCoins(coinnum);\r\n    }\r\n    despawnCoins(coin:cc.Node){\r\n        this.coinsPool.put(coin);\r\n    }\r\n    despawnCoinup(nup:cc.Node){\r\n        this.coinUpPool.put(nup);\r\n    }   \r\n\r\n\r\n}\r\n"]}